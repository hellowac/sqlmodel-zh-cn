# å¸¦æœ‰é¢å¤–å­—æ®µçš„è¿æ¥æ¨¡å‹

åœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»æœªç›´æ¥ä¸ `HeroTeamLink` æ¨¡å‹è¿›è¡Œäº¤äº’ï¼Œä¸€åˆ‡éƒ½æ˜¯é€šè¿‡è‡ªåŠ¨çš„ **å¤šå¯¹å¤š** å…³ç³»æ¥å®Œæˆçš„ã€‚

ä½†å¦‚æœæˆ‘ä»¬éœ€è¦é¢å¤–çš„æ•°æ®æ¥æè¿°ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„è¿æ¥å‘¢ï¼Ÿ

å‡è®¾æˆ‘ä»¬æƒ³è¦æœ‰ä¸€ä¸ªé¢å¤–çš„å­—æ®µ/åˆ—ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªè‹±é›„æ˜¯å¦ä»ç„¶åœ¨è¯¥é˜Ÿä¼ä¸­ **è®­ç»ƒ**ï¼Œæˆ–è€…ä»–ä»¬æ˜¯å¦å·²ç»å¼€å§‹æ‰§è¡Œä»»åŠ¡ç­‰ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®ç°è¿™ä¸€ç‚¹ã€‚

## å¸¦æœ‰ä¸¤ä¸ªä¸€å¯¹å¤šå…³ç³»çš„è¿æ¥æ¨¡å‹

å¤„ç†è¿™ç§æƒ…å†µçš„æ–¹å¼æ˜¯æ˜¾å¼åœ°ä½¿ç”¨è¿æ¥æ¨¡å‹ï¼Œä»¥ä¾¿èƒ½å¤Ÿè·å–å’Œä¿®æ”¹å…¶æ•°æ®ï¼ˆé™¤äº†æŒ‡å‘ `Hero` å’Œ `Team` ä¸¤ä¸ªæ¨¡å‹çš„å¤–é”®ï¼‰ã€‚

æœ€ç»ˆï¼Œå®ƒçš„å·¥ä½œæ–¹å¼å°±åƒæ˜¯ä¸¤ä¸ª **ä¸€å¯¹å¤š** å…³ç³»çš„ç»“åˆã€‚

åœ¨ `heroteamlink` è¡¨ä¸­çš„ä¸€è¡ŒæŒ‡å‘ **ä¸€ä¸ª** ç‰¹å®šçš„è‹±é›„ï¼Œä½†ä¸€ä¸ªè‹±é›„å¯ä»¥ä¸ **å¤šä¸ª** è‹±é›„-é˜Ÿä¼è¿æ¥ï¼Œæ‰€ä»¥æ˜¯ **ä¸€å¯¹å¤š**ã€‚

åŒæ ·ï¼Œ`heroteamlink` è¡¨ä¸­çš„åŒä¸€è¡Œä¹ŸæŒ‡å‘ **ä¸€ä¸ª** é˜Ÿä¼ï¼Œä½†ä¸€ä¸ªé˜Ÿä¼å¯ä»¥ä¸ **å¤šä¸ª** è‹±é›„-é˜Ÿä¼è¿æ¥ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ **ä¸€å¯¹å¤š**ã€‚

/// tip

ä¹‹å‰çš„å¤šå¯¹å¤šå…³ç³»å®é™…ä¸Šä¹Ÿåªæ˜¯ä¸¤ä¸ªä¸€å¯¹å¤šå…³ç³»çš„ç»“åˆï¼Œä½†ç°åœ¨å®ƒä¼šå˜å¾—æ›´åŠ æ˜¾å¼ã€‚

///

## æ›´æ–°è¿æ¥æ¨¡å‹

æˆ‘ä»¬å°†æ›´æ–° `HeroTeamLink` æ¨¡å‹ã€‚

æˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªæ–°å­—æ®µ `is_training`ã€‚

åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜ä¼šä¸ºé“¾æ¥çš„ `team` å’Œ `hero` æ·»åŠ ä¸¤ä¸ª **å…³ç³»å±æ€§**ï¼š

//// tab | Python 3.10+

```Python hl_lines="6  8-9"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:4-10]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.9+

```Python hl_lines="10  12-13"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:6-16]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.7+

```Python hl_lines="10  12-13"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:6-16]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

/// details | ğŸ‘€ å®Œæ•´æ–‡ä»¶é¢„è§ˆ

//// tab | Python 3.10+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py39.py!}
```

////

//// tab | Python 3.7+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003.py!}
```

////

///

æ–°çš„ **å…³ç³»å±æ€§** æœ‰å®ƒä»¬è‡ªå·±çš„ `back_populates`ï¼ŒæŒ‡å‘æˆ‘ä»¬å°†åœ¨ `Hero` å’Œ `Team` æ¨¡å‹ä¸­åˆ›å»ºçš„æ–°å…³ç³»å±æ€§ï¼š

* `team`ï¼šå…·æœ‰ `back_populates="hero_links"`ï¼Œå› ä¸ºåœ¨ `Team` æ¨¡å‹ä¸­ï¼Œè¯¥å±æ€§å°†åŒ…å«æŒ‡å‘ **é˜Ÿä¼è‹±é›„** çš„é“¾æ¥ã€‚
* `hero`ï¼šå…·æœ‰ `back_populates="team_links"`ï¼Œå› ä¸ºåœ¨ `Hero` æ¨¡å‹ä¸­ï¼Œè¯¥å±æ€§å°†åŒ…å«æŒ‡å‘ **è‹±é›„é˜Ÿä¼** çš„é“¾æ¥ã€‚

/// info

åœ¨ SQLAlchemy ä¸­ï¼Œè¿™è¢«ç§°ä¸ºå…³è”å¯¹è±¡æˆ–å…³è”æ¨¡å‹ï¼ˆAssociation Object æˆ– Association Modelï¼‰ã€‚

æˆ‘ç§°å…¶ä¸º **è¿æ¥æ¨¡å‹**ï¼Œä»…ä»…æ˜¯å› ä¸ºè¿™æ ·å†™æ›´ç®€å•ï¼Œé¿å…äº†æ‹¼å†™é”™è¯¯ã€‚ä½†æ‚¨ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦éšæ„å‘½åã€‚ğŸ˜‰

///

## æ›´æ–° Team æ¨¡å‹

ç°åœ¨è®©æˆ‘ä»¬æ›´æ–° `Team` æ¨¡å‹ã€‚

æˆ‘ä»¬ä¸å†ä½¿ç”¨ `heroes` å…³ç³»å±æ€§ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯æ–°çš„ `hero_links` å±æ€§ï¼š

//// tab | Python 3.10+

```Python hl_lines="8"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:13-18]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.9+

```Python hl_lines="8"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:19-24]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.7+

```Python hl_lines="8"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:19-24]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

/// details | ğŸ‘€ å®Œæ•´æ–‡ä»¶é¢„è§ˆ

//// tab | Python 3.10+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py39.py!}
```

////

//// tab | Python 3.7+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003.py!}
```

////

## æ›´æ–° Hero æ¨¡å‹

åŒæ ·çš„ï¼Œæ›´æ–° `Hero` æ¨¡å‹ã€‚

æˆ‘ä»¬å°† `teams` å…³ç³»å±æ€§æ”¹ä¸º `team_links`ï¼š

//// tab | Python 3.10+

```Python hl_lines="9"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:21-27]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.9+

```Python hl_lines="9"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:27-33]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.7+

```Python hl_lines="9"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:27-33]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

/// details | ğŸ‘€ å®Œæ•´æ–‡ä»¶é¢„è§ˆ

//// tab | Python 3.10+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py39.py!}
```

////

//// tab | Python 3.7+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003.py!}
```

////

///

## åˆ›å»ºå…³ç³»

ç°åœ¨åˆ›å»ºå…³ç³»çš„è¿‡ç¨‹éå¸¸ç›¸ä¼¼ã€‚

ä½†ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åˆ›å»º**æ˜¾å¼çš„é“¾æ¥æ¨¡å‹**ï¼Œè¿™äº›æ¨¡å‹æŒ‡å‘å®ƒä»¬çš„è‹±é›„å’Œå›¢é˜Ÿå®ä¾‹ï¼Œå¹¶æŒ‡å®šé¢å¤–çš„é“¾æ¥æ•°æ®ï¼ˆ`is_training`ï¼‰ï¼š

//// tab | Python 3.10+

```Python hl_lines="21-30  32-35"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:40-79]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.9+

```Python hl_lines="21-30  32-35"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:46-85]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.7+

```Python hl_lines="21-30  32-35"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:46-85]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

/// details | ğŸ‘€ å®Œæ•´æ–‡ä»¶é¢„è§ˆ

//// tab | Python 3.10+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py39.py!}
```

////

//// tab | Python 3.7+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003.py!}
```

////

///

æˆ‘ä»¬åªéœ€è¦å°†é“¾æ¥æ¨¡å‹å®ä¾‹æ·»åŠ åˆ°ä¼šè¯ä¸­ï¼Œå› ä¸ºé“¾æ¥æ¨¡å‹å®ä¾‹å·²ç»è¿æ¥åˆ°è‹±é›„å’Œå›¢é˜Ÿï¼Œå½“æˆ‘ä»¬æäº¤æ—¶ï¼Œå®ƒä»¬ä¹Ÿä¼šè‡ªåŠ¨åŒ…å«åœ¨ä¼šè¯ä¸­ã€‚

## è¿è¡Œç¨‹åº

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œç¨‹åºï¼Œå®ƒå°†æ˜¾ç¤ºå‡ ä¹ä¸ä¹‹å‰ç›¸åŒçš„è¾“å‡ºï¼Œå› ä¸ºå®ƒç”Ÿæˆçš„ SQL å‡ ä¹ç›¸åŒï¼Œä½†è¿™æ¬¡åŒ…æ‹¬äº†æ–°çš„ `is_training` åˆ—ï¼š

<div class="termy">

```console
$ python app.py

// çœç•¥ä¹‹å‰çš„è¾“å‡º ğŸ™ˆ

// è‡ªåŠ¨å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡
INFO Engine BEGIN (implicit)

// æ’å…¥è‹±é›„æ•°æ®
INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)
INFO Engine [generated in 0.00025s] ('Deadpond', 'Dive Wilson', None)
INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)
INFO Engine [cached since 0.00136s ago] ('Spider-Boy', 'Pedro Parqueador', None)
INFO Engine INSERT INTO hero (name, secret_name, age) VALUES (?, ?, ?)
INFO Engine [cached since 0.001858s ago] ('Rusty-Man', 'Tommy Sharp', 48)

// æ’å…¥å›¢é˜Ÿæ•°æ®
INFO Engine INSERT INTO team (name, headquarters) VALUES (?, ?)
INFO Engine [generated in 0.00019s] ('Z-Force', 'Sister Margaret's Bar')
INFO Engine INSERT INTO team (name, headquarters) VALUES (?, ?)
INFO Engine [cached since 0.0007985s ago] ('Preventers', 'Sharp Tower')

// æ’å…¥è‹±é›„-å›¢é˜Ÿé“¾æ¥æ•°æ®
INFO Engine INSERT INTO heroteamlink (team_id, hero_id, is_training) VALUES (?, ?, ?)
INFO Engine [generated in 0.00023s] ((1, 1, 0), (2, 1, 1), (2, 2, 1), (2, 3, 0))
// åœ¨äº‹åŠ¡ä¸­ä¿å­˜æ›´æ”¹åˆ°æ•°æ®åº“
INFO Engine COMMIT

// è‡ªåŠ¨å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡
INFO Engine BEGIN (implicit)

// è‡ªåŠ¨è·å–å±æ€§è®¿é—®æ—¶çš„æ•°æ®
INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters
FROM team
WHERE team.id = ?
INFO Engine [generated in 0.00028s] (1,)
INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training
FROM heroteamlink
WHERE ? = heroteamlink.team_id
INFO Engine [generated in 0.00026s] (1,)
INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age
FROM hero
WHERE hero.id = ?
INFO Engine [generated in 0.00024s] (1,)

// æ‰“å° Z-Force è‹±é›„æ•°æ®ï¼ŒåŒ…æ‹¬é“¾æ¥æ•°æ®
Z-Force hero: name='Deadpond' age=None id=1 secret_name='Dive Wilson' is training: False

// è‡ªåŠ¨è·å–å±æ€§è®¿é—®æ—¶çš„æ•°æ®
INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters
FROM team
WHERE team.id = ?
INFO Engine [cached since 0.008822s ago] (2,)
INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training
FROM heroteamlink
WHERE ? = heroteamlink.team_id
INFO Engine [cached since 0.005778s ago] (2,)

// æ‰“å° Preventers è‹±é›„æ•°æ®ï¼ŒåŒ…æ‹¬é“¾æ¥æ•°æ®
Preventers hero: name='Deadpond' age=None id=1 secret_name='Dive Wilson' is training: True

// è‡ªåŠ¨è·å–å±æ€§è®¿é—®æ—¶çš„æ•°æ®
INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age
FROM hero
WHERE hero.id = ?
INFO Engine [cached since 0.004196s ago] (2,)

// æ‰“å° Preventers è‹±é›„æ•°æ®ï¼ŒåŒ…æ‹¬é“¾æ¥æ•°æ®
Preventers hero: name='Spider-Boy' age=None id=2 secret_name='Pedro Parqueador' is training: True

// è‡ªåŠ¨è·å–å±æ€§è®¿é—®æ—¶çš„æ•°æ®
INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age
FROM hero
WHERE hero.id = ?
INFO Engine [cached since 0.006005s ago] (3,)

// æ‰“å° Preventers è‹±é›„æ•°æ®ï¼ŒåŒ…æ‹¬é“¾æ¥æ•°æ®
Preventers hero: name='Rusty-Man' age=48 id=3 secret_name='Tommy Sharp' is training: False
```

</div>

## æ·»åŠ å…³ç³»

ç°åœ¨ï¼Œè¦æ·»åŠ ä¸€ä¸ªæ–°çš„å…³ç³»ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ `HeroTeamLink` å®ä¾‹ï¼ŒæŒ‡å‘è‹±é›„å’Œå›¢é˜Ÿï¼Œæ·»åŠ åˆ°ä¼šè¯ä¸­ï¼Œç„¶åæäº¤å®ƒã€‚

è¿™é‡Œæˆ‘ä»¬åœ¨ `update_heroes()` å‡½æ•°ä¸­æ‰§è¡Œæ­¤æ“ä½œï¼š

//// tab | Python 3.10+

```Python hl_lines="10-15"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:82-97]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.9+

```Python hl_lines="10-15"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:88-103]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.7+

```Python hl_lines="10-15"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:88-103]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

/// details | ğŸ‘€ å®Œæ•´æ–‡ä»¶é¢„è§ˆ

//// tab | Python 3.10+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py39.py!}
```

////

//// tab | Python 3.7+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003.py!}
```

////

///

## ä½¿ç”¨æ–°å…³ç³»è¿è¡Œç¨‹åº

å¦‚æœæˆ‘ä»¬è¿è¡Œè¯¥ç¨‹åºï¼Œå°†çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

<div class="termy">

```console
$ python app.py

// çœç•¥ä¹‹å‰çš„è¾“å‡º ğŸ™ˆ

// è‡ªåŠ¨å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡
INFO Engine BEGIN (implicit)

// é€‰æ‹©è‹±é›„
INFO Engine SELECT hero.id, hero.name, hero.secret_name, hero.age
FROM hero
WHERE hero.name = ?
INFO Engine [no key 0.00014s] ('Spider-Boy',)

// é€‰æ‹©å›¢é˜Ÿ
INFO Engine SELECT team.id, team.name, team.headquarters
FROM team
WHERE team.name = ?
INFO Engine [no key 0.00012s] ('Z-Force',)

// åˆ›å»ºé“¾æ¥
INFO Engine INSERT INTO heroteamlink (team_id, hero_id, is_training) VALUES (?, ?, ?)
INFO Engine [generated in 0.00023s] (1, 2, 1)

// è‡ªåŠ¨åˆ·æ–°æ•°æ®ï¼Œè®¿é—®å±æ€§æ—¶
INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training
FROM heroteamlink
WHERE ? = heroteamlink.team_id
INFO Engine [cached since 0.01514s ago] (1,)
INFO Engine COMMIT
INFO Engine BEGIN (implicit)
INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age
FROM hero
WHERE hero.id = ?
INFO Engine [cached since 0.08953s ago] (2,)
INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training
FROM heroteamlink
WHERE ? = heroteamlink.hero_id
INFO Engine [generated in 0.00018s] (2,)

// æ‰“å°æ›´æ–°åçš„è‹±é›„é“¾æ¥
Updated Spider-Boy's Teams: [
    HeroTeamLink(team_id=2, is_training=True, hero_id=2),
    HeroTeamLink(team_id=1, is_training=True, hero_id=2)
]

// è‡ªåŠ¨åˆ·æ–°å›¢é˜Ÿæ•°æ®ï¼Œè®¿é—®å±æ€§æ—¶
INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters
FROM team
WHERE team.id = ?
INFO Engine [cached since 0.1084s ago] (1,)
INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training
FROM heroteamlink
WHERE ? = heroteamlink.team_id
INFO Engine [cached since 0.1054s ago] (1,)

// æ‰“å°å›¢é˜Ÿè‹±é›„é“¾æ¥
Z-Force heroes: [
    HeroTeamLink(team_id=1, is_training=False, hero_id=1),
    HeroTeamLink(team_id=1, is_training=True, hero_id=2)
]
```

</div>

## ä½¿ç”¨é“¾æ¥æ›´æ–°å…³ç³»

ç°åœ¨å‡è®¾ **Spider-Boy** åœ¨ **Preventers** è®­ç»ƒå¾—è¶³å¤Ÿä¹…ï¼Œå›¢é˜ŸåŒæ„ä»–å¯ä»¥å…¨èŒåŠ å…¥ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨å¸Œæœ›å°† `is_training` çš„çŠ¶æ€æ›´æ–°ä¸º `False`ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿­ä»£é“¾æ¥æ¥å®ç°è¿™ä¸€ç‚¹ï¼š

//// tab | Python 3.10+

```Python hl_lines="8-10"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:82-83]!}

        # ä»£ç çœç•¥ ğŸ‘ˆ

{!./docs_src/tutorial/many_to_many/tutorial003_py310.py[ln:99-107]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.9+

```Python hl_lines="8-10"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:88-89]!}

        # ä»£ç çœç•¥ ğŸ‘ˆ

{!./docs_src/tutorial/many_to_many/tutorial003_py39.py[ln:105-113]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

//// tab | Python 3.7+

```Python hl_lines="8-10"
# ä»£ç çœç•¥ ğŸ‘†

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:88-89]!}

        # ä»£ç çœç•¥ ğŸ‘ˆ

{!./docs_src/tutorial/many_to_many/tutorial003.py[ln:105-113]!}

# ä»£ç çœç•¥ ğŸ‘‡
```

////

/// details | ğŸ‘€ å®Œæ•´æ–‡ä»¶é¢„è§ˆ

//// tab | Python 3.10+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py310.py!}
```

////

//// tab | Python 3.9+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003_py39.py!}
```

////

//// tab | Python 3.7+

```Python
{!./docs_src/tutorial/many_to_many/tutorial003.py!}
```

////

///

## ä½¿ç”¨æ›´æ–°åçš„å…³ç³»è¿è¡Œç¨‹åº

å¦‚æœæˆ‘ä»¬ç°åœ¨è¿è¡Œç¨‹åºï¼Œå®ƒå°†è¾“å‡ºï¼š

<div class="termy">

```console
$ python app.py

// çœç•¥ä¹‹å‰çš„è¾“å‡º ğŸ™ˆ

// è‡ªåŠ¨é€šè¿‡å±æ€§è®¿é—®è·å–å›¢é˜Ÿæ•°æ®
INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters
FROM team
WHERE team.id = ?
INFO Engine [generated in 0.00015s] (2,)

// æ›´æ–°é“¾æ¥è¡Œ
INFO Engine UPDATE heroteamlink SET is_training=? WHERE heroteamlink.team_id = ? AND heroteamlink.hero_id = ?
INFO Engine [generated in 0.00020s] (0, 2, 2)

// ä¿å­˜å½“å‰äº‹åŠ¡åˆ°æ•°æ®åº“
INFO Engine COMMIT

// è‡ªåŠ¨å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡
INFO Engine BEGIN (implicit)

// è‡ªåŠ¨é€šè¿‡å±æ€§è®¿é—®è·å–æ•°æ®
INFO Engine SELECT hero.id AS hero_id, hero.name AS hero_name, hero.secret_name AS hero_secret_name, hero.age AS hero_age
FROM hero
WHERE hero.id = ?
INFO Engine [cached since 0.2004s ago] (2,)
INFO Engine SELECT heroteamlink.team_id AS heroteamlink_team_id, heroteamlink.hero_id AS heroteamlink_hero_id, heroteamlink.is_training AS heroteamlink_is_training
FROM heroteamlink
WHERE ? = heroteamlink.hero_id
INFO Engine [cached since 0.1005s ago] (2,)
INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters
FROM team
WHERE team.id = ?
INFO Engine [cached since 0.09707s ago] (2,)

// æ‰“å° Spider-Boy çš„å›¢é˜Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é“¾æ¥æ•°æ®ï¼Œæ£€æŸ¥æ˜¯å¦åœ¨è®­ç»ƒ
Spider-Boy team: headquarters='Sharp Tower' id=2 name='Preventers' is training: False

// è‡ªåŠ¨é€šè¿‡å±æ€§è®¿é—®è·å–æ•°æ®
INFO Engine SELECT team.id AS team_id, team.name AS team_name, team.headquarters AS team_headquarters
FROM team
WHERE team.id = ?
INFO Engine [cached since 0.2097s ago] (1,)

// æ‰“å° Spider-Boy çš„å›¢é˜Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é“¾æ¥æ•°æ®ï¼Œæ£€æŸ¥æ˜¯å¦åœ¨è®­ç»ƒ
Spider-Boy team: headquarters='Sister Margaret's Bar' id=1 name='Z-Force' is training: True
INFO Engine ROLLBACK
```

</div>

## æ€»ç»“

å¦‚æœæ‚¨éœ€è¦å­˜å‚¨æ›´å¤šå…³äº **å¤šå¯¹å¤š** å…³ç³»çš„ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ˜¾å¼çš„é“¾æ¥æ¨¡å‹ï¼Œå¹¶åœ¨å…¶ä¸­åŒ…å«é¢å¤–çš„æ•°æ®ã€‚ğŸ¤“
